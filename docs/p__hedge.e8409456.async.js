(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[98],{20419:function(ue,q,s){"use strict";s.r(q),s.d(q,{default:function(){return Wt}});var se=s(77576),St=s(12028),ie=s(17462),yt=s(76772),B=s(2824),x=s(39428),U=s(3182),Zt=s(21349),F=s(54433),g=s(52778),_=s(70719),A=s(11238),Bt=s(81354),M=s.n(Bt),tt=s(952),et=s(64317),e=s(85893),Ft=function(a){var t=a.accounts,r=a.updateKey,n=a.balances;if(!t)return(0,e.jsx)(e.Fragment,{});var l=t.reduce(function(c,u,i){return c[i]="[".concat(u.env,"]").concat(u.alias),c},{});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.ZP,{ghost:!0,children:(0,e.jsx)(tt.ZP,{submitter:!1,onValuesChange:function(u){"account"in u&&(console.log("updateKey"),r("spot",{ak:t[u.account].ak,sk:t[u.account].sk}))},children:(0,e.jsx)(et.Z,{name:"account",label:"\u73B0\u8D27\u8D26\u6237",valueEnum:l})})}),n&&n.USDT&&(0,e.jsxs)(F.ZP,{wrap:!0,ghost:!0,children:[(0,e.jsx)(g.Z,{ghost:!0,statistic:{value:n.USDT.free,title:"USDT.free:"}}),(0,e.jsx)(g.Z,{ghost:!0,statistic:{value:n.BTC.free,title:"BTC.free:"}})]})]})},f=s(67294),P=s(56139),jt=s(30381),k=s.n(jt);function at(a,t,r,n){return Y.apply(this,arguments)}function Y(){return Y=(0,U.Z)((0,x.Z)().mark(function a(t,r,n,l){var c,u,i;return(0,x.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return c=Date.now(),n.timestamp=c,u=Object.keys(n).map(function(y){return"".concat(y,"=").concat(n[y])}).join("&"),i=M().HmacSHA256(u,l.sk).toString(),v.abrupt("return",(0,A.ZP)(r+"/api/?"+u+"&signature="+i,{method:"POST",headers:{"X-MBX-APIKEY":l.ak,"X-URL":t}}));case 5:case"end":return v.stop()}},a)})),Y.apply(this,arguments)}function bt(a,t,r,n){return H.apply(this,arguments)}function H(){return H=(0,U.Z)((0,x.Z)().mark(function a(t,r,n,l){var c,u,i,b;return(0,x.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(c=Date.now(),u={symbol:"BTCUSDT",side:"BUY",type:"MARKET",quantity:n,timestamp:c,recvWindow:5e3},!(!l||!l.ak)){y.next=4;break}return y.abrupt("return",new Promise(function(j,K){K("\u672A\u6DFB\u52A0\u73B0\u8D27\u8D26\u6237")}));case 4:return i=Object.keys(u).map(function(j){return"".concat(j,"=").concat(u[j])}).join("&"),b=M().HmacSHA256(i,l.sk).toString(),y.abrupt("return",(0,A.ZP)(r+"/api/?"+i+"&signature="+b,{method:"POST",headers:{"X-MBX-APIKEY":l.ak,"X-URL":t+"/api/v3/order"},parseResponse:!1}));case 7:case"end":return y.stop()}},a)})),H.apply(this,arguments)}function Dt(a,t,r,n,l,c){return O.apply(this,arguments)}function O(){return O=(0,U.Z)((0,x.Z)().mark(function a(t,r,n,l,c,u){var i;return(0,x.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(!u||!u.ak)){v.next=2;break}return v.abrupt("return",new Promise(function(y,j){j("\u672A\u6DFB\u52A0\u671F\u8D27\u8D26\u6237")}));case 2:return v.next=4,at(t+"/dapi/v1/leverage",r,{symbol:n,leverage:l},u);case 4:return i=v.sent,v.abrupt("return",at(t+"/dapi/v1/order",r,{symbol:n,side:"SELL",quantity:c,type:"MARKET"},u));case 6:case"end":return v.stop()}},a)})),O.apply(this,arguments)}function Tt(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date,t=a.getFullYear(),r=a.getMonth()+1,n,l;r>=1&&r<=3?(n=new Date(t,3,0),l=new Date(t,6,0)):r>=4&&r<=6?(n=new Date(t,6,0),l=new Date(t,9,0)):r>=7&&r<=9?(n=new Date(t,9,0),l=new Date(t,12,0)):(n=new Date(t,12,0),l=new Date(t+1,3,0));var c=k()(a),u=k()(n),i=k()(l);return{quarter:[u.format("YYMMDD"),u.diff(c,"days")],nextQuarter:[i.format("YYMMDD"),i.diff(c,"days")]}}function rt(a,t){if(!t)return a.actuals_price;if(t==a.quarter)return a.futures_price;if(t==a.nextQuarter)return a.futures_next_price}function Et(a,t){return a.reduce(function(r,n,l){return r[n[t]]=n,r},{})}function Pt(a){return a?a.reduce(function(t,r,n){return t[n]="[".concat(r.env,"]").concat(r.alias),t},{}):[]}function Ct(a){if(a&&a.assets){var t=a.assets.find(function(r){return r.asset==="BTC"});return t}else return null}function nt(a){return a&&a.positions?a.positions.filter(function(t){return t.positionAmt!=0}):[]}function Ut(a){var t=new P.Z(0);return a&&a.positions?(t=a.positions.reduce(function(r,n){return n.symbol.startsWith("BTCUSD")&&n.positionAmt!=0&&(r=P.Z.add(r,n.notionalValue)),r},t),t.toString()):0}function At(a){if(a&&a.positions){var t=a.positions.filter(function(r){return r.symbol.startsWith("BTCUSD")});return t.reduce(function(r,n){return r[n.symbol]=n.symbol,r},{})}else return{}}function wt(a){var t={};return t[a.quarter]=a.quarter,t[a.nextQuarter]=a.nextQuarter,t}var It=function(a){var t=a.accounts,r=a.updateKey,n=a.balances;if(!t)return(0,e.jsx)(e.Fragment,{});var l=Pt(t),c=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5408\u7EA6",dataIndex:"symbol",copyable:!0},{title:"x",dataIndex:"leverage"},{title:"\u6570\u91CF",dataIndex:"positionAmt"},{title:"\u4FDD\u8BC1\u91D1\u5360\u7528",dataIndex:"notionalValue"},{title:"\u6301\u4ED3\u6210\u672C",dataIndex:"entryPrice"},{title:"\u7EF4\u6301\u4FDD\u8BC1\u91D1",dataIndex:"maintMargin"},{title:"\u672A\u5B9E\u73B0\u76C8\u4E8F",dataIndex:"unrealizedProfit"},{title:"\u6700\u5927\u53EF\u5F00\u4ED3\u6570",dataIndex:"maxQty"}],u=null,i=[];n&&n.assets&&(u=Ct(n),i=nt(n));var b=g.Z.Statistic,v=g.Z.Divider;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.ZP,{ghost:!0,children:(0,e.jsx)(tt.ZP,{submitter:!1,onValuesChange:function(j){"account"in j&&(console.log("updateKey"),r("future",{ak:t[j.account].ak,sk:t[j.account].sk}))},children:(0,e.jsx)(et.Z,{name:"account",label:"\u671F\u8D27\u8D26\u6237",valueEnum:l})})}),n&&u&&(0,e.jsxs)(F.ZP,{wrap:!0,ghost:!0,children:[(0,e.jsxs)(g.Z.Group,{children:[(0,e.jsx)(g.Z,{ghost:!0,statistic:{value:u.availableBalance,title:"\u53EF\u7528BTC:"}}),(0,e.jsx)(F.ZP.Divider,{}),(0,e.jsx)(g.Z,{ghost:!0,statistic:{value:u.maintMargin,title:"\u7EF4\u6301\u4FDD\u8BC1\u91D1:"}})]}),(0,e.jsxs)(g.Z.Group,{children:[(0,e.jsx)(g.Z,{ghost:!0,statistic:{value:u.marginBalance,title:"\u4FDD\u8BC1\u91D1\u4F59\u989D:"}}),(0,e.jsx)(F.ZP.Divider,{}),(0,e.jsx)(g.Z,{ghost:!0,statistic:{value:u.walletBalance,title:"\u94B1\u5305\u4F59\u989D:"}})]})]})]})},Rt=s(48717),R=g.Z.Statistic,Kt=function(a){var t=a.data,r=(0,f.useState)(!1),n=(0,B.Z)(r,2),l=n[0],c=n[1];return(0,e.jsx)(Rt.Z,{onResize:function(i){c(i.width<692)},children:(0,e.jsxs)(g.Z.Group,{direction:l?"column":"row",span:24,children:[(0,e.jsx)(g.Z,{title:"\u73B0\u8D27\u4EF7\u683C",statistic:{value:(+t.actuals_price).toFixed(2),suffix:"USDT",valueStyle:{fontWeight:"bold"}}}),(0,e.jsx)(g.Z,{title:"\u5F53\u5B63: "+t.quarter,statistic:{value:((t.futures_price-t.actuals_price)*100*365/(t.actuals_price*t.left_days)).toFixed(2),prefix:(0,e.jsx)("span",{style:{fontSize:16},children:"\u5E74\u5316"}),valueStyle:{fontWeight:"bold"},suffix:"%"},extra:(0,e.jsx)(R,{value:t.left_days,title:"\u5269\u4F59\u5929\u6570: ",layout:"horizontal"}),footer:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R,{value:(+t.futures_price).toFixed(2),suffix:"USDT",title:"\u671F\u8D27\u4EF7\u683C",layout:"horizontal"}),(0,e.jsx)(R,{value:((t.futures_price-t.actuals_price)*100/t.actuals_price).toFixed(2),suffix:"%",title:"margin",layout:"horizontal"})]})}),(0,e.jsx)(g.Z,{title:"\u6B21\u5B63: "+t.nextQuarter,statistic:{value:((t.futures_next_price-t.actuals_price)*100*365/(t.actuals_price*t.left_next_days)).toFixed(2),prefix:(0,e.jsx)("span",{style:{fontSize:16},children:"\u5E74\u5316"}),valueStyle:{fontWeight:"bold"},suffix:"%"},extra:(0,e.jsx)(R,{value:t.left_next_days,title:"\u5269\u4F59\u5929\u6570: ",layout:"horizontal"}),footer:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R,{value:(+t.futures_next_price).toFixed(2),suffix:"USDT",title:"\u671F\u8D27\u4EF7\u683C",layout:"horizontal"}),(0,e.jsx)(R,{value:((t.futures_next_price-t.actuals_price)*100/t.actuals_price).toFixed(2),suffix:"%",title:"margin",layout:"horizontal"})]})})]})},"resize-observer")},Mt=s(84232),Qt=function(a){var t=a.balances;if(!t)return(0,e.jsx)(e.Fragment,{});var r=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5408\u7EA6",dataIndex:"symbol",copyable:!0},{title:"x",dataIndex:"leverage"},{title:"\u6570\u91CF",dataIndex:"positionAmt"},{title:"\u4FDD\u8BC1\u91D1\u5360\u7528",dataIndex:"notionalValue"},{title:"\u6301\u4ED3\u6210\u672C",dataIndex:"entryPrice"},{title:"\u7EF4\u6301\u4FDD\u8BC1\u91D1",dataIndex:"maintMargin"},{title:"\u672A\u5B9E\u73B0\u76C8\u4E8F",dataIndex:"unrealizedProfit"},{title:"\u6700\u5927\u53EF\u5F00\u4ED3\u6570",dataIndex:"maxQty"}],n=[];return t&&t.assets&&(n=nt(t)),(0,e.jsx)(F.ZP,{span:{xs:24,l:12},children:t&&(0,e.jsx)(Mt.ZP,{columns:r,dataSource:n,rowKey:"symbol",search:!1,options:{setting:{listsHeight:400}},dateFormatter:"string"})})},le=s(57663),zt=s(71577),Q=s(80291),$=s(60014),ut=s(25641),Gt=function(a){var t=a.marketData,r=a.spotKey,n=a.futureBtcSymbols,l=a.futureKey,c=a.spotUrl,u=a.futureUrl,i=(0,f.useRef)(),b=(0,f.useState)(!1),v=(0,B.Z)(b,2),y=v[0],j=v[1],K=function(){var D,Z;(D=i.current)===null||D===void 0||(Z=D.validateFieldsReturnFormatValue)===null||Z===void 0||Z.call(D).then(function(C){j(!0);var z=rt(t,C.symbol),G=P.Z.floor(P.Z.div(P.Z.mul(C.btc,z),100)),L=bt(c,"https://m1-coin.littlebrother.icu",C.btc,r),V=Dt(u,"https://m1-coin.littlebrother.icu",C.symbol,C.leverage,G.toString(),l);L.then(function(E){console.log("\u73B0\u8D27\u8D2D\u4E70\u6210\u529F\uFF1A",E)}).catch(function(E){console.log(E)}),V.then(function(E){console.log("\u671F\u8D27\u8D2D\u4E70\u6210\u529F\uFF1A",E)}).catch(function(E){console.log("\u671F\u8D27\u8D2D\u4E70\u5931\u8D25\uFF1A",E)}),Promise.all([L,V]).finally(function(){j(!1)})})};return(0,f.useEffect)(function(){var T;i==null||(T=i.current)===null||T===void 0||T.setFieldsValue({symbol:n?Object.keys(n)[0]:""})},[n]),(0,e.jsxs)(Q.A,{grid:!0,rowProps:{gutter:[16,16]},layout:"inline",submitter:!1,formRef:i,initialValues:{leverage:"1"},onValuesChange:function(D){if("btc"in D){var Z,C=rt(t,D.symbol);i==null||(Z=i.current)===null||Z===void 0||Z.setFieldsValue({btcAmt:D.btc,btcCont:P.Z.floor(P.Z.div(P.Z.mul(D.btc,C),100))})}},children:[(0,e.jsxs)(Q.A.Group,{children:[(0,e.jsx)($.Z,{label:"BTC",name:"btc",width:"sm",required:!0,colProps:{md:12,xl:8}}),(0,e.jsx)(ut.Z,{colProps:{md:12,xl:8},name:"leverage",label:"\u6760\u6746",width:"sm",valueEnum:Array.from({length:50}).reduce(function(T,D,Z){return T[Z+1]="x"+(Z+1),T},{})}),(0,e.jsx)(ut.Z,{colProps:{md:12,xl:8},width:"sm",name:"symbol",label:"\u5408\u7EA6",valueEnum:n})]}),(0,e.jsxs)(Q.A.Group,{children:[(0,e.jsx)($.Z,{readonly:!0,label:"\u73B0\u8D27\u4E70\u5165BTC\u6570\u91CF",name:"btcAmt",width:"sm",colProps:{md:12,xl:12}}),(0,e.jsx)($.Z,{colProps:{md:12,xl:12},readonly:!0,label:"\u671F\u8D27\u5356\u51FA\u5F20\u6570\uFF08100USD/\u5F20\uFF09",name:"btcCont",width:"sm"})]}),(0,e.jsx)(Q.A.Group,{children:(0,e.jsx)(zt.Z,{type:"primary",loading:y,onClick:K,children:"\u5E02\u4EF7\u4E70\u5165BTC\u73B0\u8D27\uFF0C\u5356\u51FABTC\u671F\u6743"})})]})},w={SPOT:"https://api.binance.com",SPOT_TEST:"https://testnet.binance.vision",FUTURE:"https://dapi.binance.com",FUTURE_TEST:"https://testnet.binancefuture.com"},Vt=function(){var a=(0,U.Z)((0,x.Z)().mark(function t(){return(0,x.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,_.WY)("https://m1-coin.littlebrother.icu/account/",{method:"GET",headers:{"Content-Type":"application/json"}}));case 1:case"end":return n.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),Wt=function(){var a=(0,f.useState)("_TEST"),t=(0,B.Z)(a,2),r=t[0],n=t[1],l=function(){var S=(0,U.Z)((0,x.Z)().mark(function d(p){var m;return(0,x.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return m=Date.now(),o.abrupt("return",A.ZP.get("https://m1-coin.littlebrother.icu/api/",{method:"GET",headers:{"X-MBX-APIKEY":p.ak,"X-URL":w["SPOT"+r]+"/api/v3/account"},params:{timestamp:m,recvWindow:5e3,signature:M().HmacSHA256("timestamp=".concat(m,"&recvWindow=5000"),p.sk).toString()}}));case 2:case"end":return o.stop()}},d)}));return function(p){return S.apply(this,arguments)}}(),c=function(){var S=(0,U.Z)((0,x.Z)().mark(function d(p){var m;return(0,x.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return m=Date.now(),o.abrupt("return",A.ZP.get("https://m1-coin.littlebrother.icu/api/",{method:"GET",headers:{"X-MBX-APIKEY":p.ak,"X-URL":w["FUTURE"+r]+"/dapi/v1/account"},params:{timestamp:m,recvWindow:5e3,signature:M().HmacSHA256("timestamp=".concat(m,"&recvWindow=5000"),p.sk).toString()}}));case 2:case"end":return o.stop()}},d)}));return function(p){return S.apply(this,arguments)}}(),u=(0,f.useState)({actuals_price:0,futures_price:0,futures_next_price:0,left_days:10,left_next_days:10,quarter:"BTCUSD_",nextQuarter:"BTCUSD"}),i=(0,B.Z)(u,2),b=i[0],v=i[1],y=function(){var d=Tt(),p=A.ZP.get(w["SPOT"+r]+"/api/v3/ticker/price?symbol=BTCUSDT"),m=A.ZP.get(w["FUTURE"+r]+"/dapi/v1/ticker/price?symbol=BTCUSD_".concat(d.quarter[0])),I=A.ZP.get(w["FUTURE"+r]+"/dapi/v1/ticker/price?symbol=BTCUSD_".concat(d.nextQuarter[0]));Promise.all([p,m,I]).then(function(o){var h=(0,B.Z)(o,3),ee=h[0],ae=h[1],re=h[2],ne={actuals_price:ee.price,futures_price:ae[0].price,futures_next_price:re[0].price,left_days:d.quarter[1],left_next_days:d.nextQuarter[1],quarter:"BTCUSD_"+d.quarter[0],nextQuarter:"BTCUSD_"+d.nextQuarter[0]};v(ne)})};(0,f.useEffect)(function(){var S=setInterval(function(){y()},1e3);return function(){return clearInterval(S)}},[r]);var j=(0,f.useState)(null),K=(0,B.Z)(j,2),T=K[0],D=K[1];(0,f.useEffect)(function(){D(wt(b))},[b.quarter]);var Z=(0,_.QT)(Vt),C=(0,f.useState)(5),z=(0,B.Z)(C,2),G=z[0],L=z[1],V=(0,f.useState)(0),E=(0,B.Z)(V,2),N=E[0],Xt=E[1],kt=(0,f.useState)(0),st=(0,B.Z)(kt,2),J=st[0],Yt=st[1],Ht=(0,f.useState)(null),it=(0,B.Z)(Ht,2),W=it[0],Ot=it[1],$t=(0,f.useState)(null),lt=(0,B.Z)($t,2),X=lt[0],Lt=lt[1],ot=function(d,p){var m=d=="spot"?Ot:Lt;m(p)},Nt=(0,f.useState)({}),ct=(0,B.Z)(Nt,2),Jt=ct[0],dt=ct[1],ft=function(){var S=(0,U.Z)((0,x.Z)().mark(function d(){var p,m;return(0,x.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(W){o.next=2;break}return o.abrupt("return");case 2:return o.prev=2,o.next=5,l(W);case 5:p=o.sent,m=Et(p.balances,"asset"),dt(m),Xt(m.BTC.free),o.next=15;break;case 11:o.prev=11,o.t0=o.catch(2),console.log(o.t0),dt({});case 15:case"end":return o.stop()}},d,null,[[2,11]])}));return function(){return S.apply(this,arguments)}}();(0,f.useEffect)(function(){ft();var S=setInterval(ft,G*1e3);return function(){clearInterval(S)}},[W,r]);var qt=(0,f.useState)({}),vt=(0,B.Z)(qt,2),pt=vt[0],mt=vt[1],ht=function(){var S=(0,U.Z)((0,x.Z)().mark(function d(){var p,m,I;return(0,x.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(X){h.next=2;break}return h.abrupt("return");case 2:return h.prev=2,h.next=5,c(X);case 5:p=h.sent,m=At(p),I=Ut(p),mt(p),Yt(I),h.next=16;break;case 12:h.prev=12,h.t0=h.catch(2),console.log(h.t0),mt({});case 16:case"end":return h.stop()}},d,null,[[2,12]])}));return function(){return S.apply(this,arguments)}}();(0,f.useEffect)(function(){ht();var S=setInterval(ht,G*1e3);return function(){clearInterval(S)}},[X,r]);var _t=(0,f.useState)(null),xt=(0,B.Z)(_t,2),gt=xt[0],te=xt[1];return(0,f.useEffect)(function(){typeof+N=="number"&&typeof+J=="number"&&te(P.Z.add(N,J))},[N,J,r]),(0,e.jsxs)(Zt.Z,{children:[r=="_TEST"&&(0,e.jsx)(yt.Z,{message:"\u6CE8\u610F\uFF1A\u5F53\u524D\u4E3A\u6D4B\u8BD5\u6A21\u5F0F\uFF0C\u8C03\u7528\u7684\u63A5\u53E3\u5747\u4E3A\u5E01\u5B89\u6D4B\u8BD5\u7F51\u7EDC",banner:!0}),(0,e.jsx)(F.ZP,{ghost:!0,style:{marginBottom:20},title:"\u73B0\u8D27\u671F\u8D27\u5BF9\u51B2\u5957\u5229(BTC)",extra:(0,e.jsx)(St.Z,{defaultChecked:r!="_TEST",checkedChildren:"\u7EBF\u4E0A",unCheckedChildren:"\u6D4B\u8BD5",onChange:function(d){n(d?"":"_TEST")}}),children:(0,e.jsx)(Kt,{data:b})}),Z.loading==!1&&Z.data&&(0,e.jsxs)(F.ZP,{ghost:!0,wrap:!0,style:{marginBottom:20},children:[(0,e.jsx)(F.ZP,{colSpan:12,children:(0,e.jsx)(Ft,{accounts:Z.data,updateKey:ot,balances:Jt})}),(0,e.jsx)(F.ZP,{colSpan:12,children:(0,e.jsx)(It,{accounts:Z.data,updateKey:ot,balances:pt})})]}),(0,e.jsx)(F.ZP,{ghost:!0,style:{marginBottom:20},children:(0,e.jsx)(Qt,{balances:pt})}),(0,e.jsx)(F.ZP,{ghost:!0,style:{marginBottom:20},children:(0,e.jsx)(g.Z,{title:"BTC\u98CE\u9669\u655E\u53E3",statistic:{value:gt&&gt.toString(),suffix:"BTC",valueStyle:{fontWeight:"bold"}}})}),(0,e.jsx)(F.ZP,{style:{marginBottom:20},children:(0,e.jsx)(Gt,{futureBtcSymbols:T,marketData:b,spotKey:W,futureKey:X,spotUrl:w["SPOT"+r],futureUrl:w["FUTURE"+r]})})]})}},42480:function(){}}]);
