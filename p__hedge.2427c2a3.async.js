(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[98],{3597:function(ue,$,l){"use strict";l.r($),l.d($,{default:function(){return Gt}});var se=l(57663),gt=l(71577),ie=l(77576),St=l(12028),le=l(17462),Zt=l(76772),Z=l(2824),g=l(39428),D=l(3182),yt=l(21349),y=l(54433),S=l(52778),L=l(70719),E=l(11238),Bt=l(81354),I=l.n(Bt),C=l(952),N=l(64317),e=l(85893),Ft=function(a){var t=a.accounts,r=a.updateKey,n=a.balances;if(!t)return(0,e.jsx)(e.Fragment,{});var d=t.reduce(function(v,s,p){return v[p]="[".concat(s.env,"]").concat(s.alias),v},{});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.ZP,{ghost:!0,children:(0,e.jsx)(C.ZP,{submitter:!1,onValuesChange:function(s){"account"in s&&(console.log("updateKey"),r("spot",{ak:t[s.account].ak,sk:t[s.account].sk}))},children:(0,e.jsx)(N.Z,{name:"account",label:"\u73B0\u8D27\u8D26\u6237",valueEnum:d})})}),n&&n.USDT&&(0,e.jsxs)(y.ZP,{wrap:!0,ghost:!0,children:[(0,e.jsx)(S.Z,{ghost:!0,statistic:{value:n.USDT.free,title:"USDT.free:"}}),(0,e.jsx)(S.Z,{ghost:!0,statistic:{value:n.BTC.free,title:"BTC.free:"}})]})]})},h=l(67294),T=l(56139),jt=l(30381),G=l.n(jt);function J(a,t,r,n){return V.apply(this,arguments)}function V(){return V=(0,D.Z)((0,g.Z)().mark(function a(t,r,n,d){var v,s,p;return(0,g.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return v=Date.now(),n.timestamp=v,s=Object.keys(n).map(function(F){return"".concat(F,"=").concat(n[F])}).join("&"),p=I().HmacSHA256(s,d.sk).toString(),x.abrupt("return",(0,E.ZP)(r+"/api/?"+s+"&signature="+p,{method:"POST",headers:{"X-MBX-APIKEY":d.ak,"X-URL":t}}));case 5:case"end":return x.stop()}},a)})),V.apply(this,arguments)}function Tt(a,t,r,n){return W.apply(this,arguments)}function W(){return W=(0,D.Z)((0,g.Z)().mark(function a(t,r,n,d){var v,s,p,B;return(0,g.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(v=Date.now(),s={symbol:"BTCUSDT",side:"BUY",type:"MARKET",quantity:n,timestamp:v,recvWindow:5e3},!(!d||!d.ak)){F.next=4;break}return F.abrupt("return",new Promise(function(){}));case 4:return p=Object.keys(s).map(function(b){return"".concat(b,"=").concat(s[b])}).join("&"),B=I().HmacSHA256(p,d.sk).toString(),F.abrupt("return",(0,E.ZP)(r+"/api/?"+p+"&signature="+B,{method:"POST",headers:{"X-MBX-APIKEY":d.ak,"X-URL":t+"/api/v3/order"}}));case 7:case"end":return F.stop()}},a)})),W.apply(this,arguments)}function Dt(a,t,r,n,d,v){return X.apply(this,arguments)}function X(){return X=(0,D.Z)((0,g.Z)().mark(function a(t,r,n,d,v,s){var p;return(0,g.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!(!s||!s.ak)){x.next=2;break}return x.abrupt("return",new Promise(function(){}));case 2:return x.next=4,J(t+"/dapi/v1/leverage",r,{symbol:n,leverage:d},s);case 4:return p=x.sent,x.abrupt("return",J(t+"/dapi/v1/order",r,{symbol:n,side:"SELL",quantity:v,type:"MARKET"},s));case 6:case"end":return x.stop()}},a)})),X.apply(this,arguments)}function bt(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date,t=a.getFullYear(),r=a.getMonth()+1,n,d;r>=1&&r<=3?(n=new Date(t,3,0),d=new Date(t,6,0)):r>=4&&r<=6?(n=new Date(t,6,0),d=new Date(t,9,0)):r>=7&&r<=9?(n=new Date(t,9,0),d=new Date(t,12,0)):(n=new Date(t,12,0),d=new Date(t+1,3,0));var v=G()(a),s=G()(n),p=G()(d);return{quarter:[s.format("YYMMDD"),s.diff(v,"days")],nextQuarter:[p.format("YYMMDD"),p.diff(v,"days")]}}function q(a,t){if(!t)return a.actuals_price;if(t==a.quarter)return a.futures_price;if(t==a.nextQuarter)return a.futures_next_price}function Et(a,t){return a.reduce(function(r,n,d){return r[n[t]]=n,r},{})}function Pt(a){return a?a.reduce(function(t,r,n){return t[n]="[".concat(r.env,"]").concat(r.alias),t},{}):[]}function Ct(a){if(a&&a.assets){var t=a.assets.find(function(r){return r.asset==="BTC"});return t}else return null}function _(a){return a&&a.positions?a.positions.filter(function(t){return t.positionAmt!=0}):[]}function wt(a){var t=new T.Z(0);return a&&a.positions?(t=a.positions.reduce(function(r,n){return n.symbol.startsWith("BTCUSD")&&n.positionAmt!=0&&(r=T.Z.add(r,n.notionalValue)),r},t),t.toString()):0}function At(a){if(a&&a.positions){var t=a.positions.filter(function(r){return r.symbol.startsWith("BTCUSD")});return t.reduce(function(r,n){return r[n.symbol]=n.symbol,r},{})}else return{}}function Ut(a){var t={};return t[a.quarter]=a.quarter,t[a.nextQuarter]=a.nextQuarter,t}var It=function(a){var t=a.accounts,r=a.updateKey,n=a.balances;if(!t)return(0,e.jsx)(e.Fragment,{});var d=Pt(t),v=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5408\u7EA6",dataIndex:"symbol",copyable:!0},{title:"x",dataIndex:"leverage"},{title:"\u6570\u91CF",dataIndex:"positionAmt"},{title:"\u4FDD\u8BC1\u91D1\u5360\u7528",dataIndex:"notionalValue"},{title:"\u6301\u4ED3\u6210\u672C",dataIndex:"entryPrice"},{title:"\u7EF4\u6301\u4FDD\u8BC1\u91D1",dataIndex:"maintMargin"},{title:"\u672A\u5B9E\u73B0\u76C8\u4E8F",dataIndex:"unrealizedProfit"},{title:"\u6700\u5927\u53EF\u5F00\u4ED3\u6570",dataIndex:"maxQty"}],s=null,p=[];n&&n.assets&&(s=Ct(n),p=_(n));var B=S.Z.Statistic,x=S.Z.Divider;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.ZP,{ghost:!0,children:(0,e.jsx)(C.ZP,{submitter:!1,onValuesChange:function(b){"account"in b&&(console.log("updateKey"),r("future",{ak:t[b.account].ak,sk:t[b.account].sk}))},children:(0,e.jsx)(N.Z,{name:"account",label:"\u671F\u8D27\u8D26\u6237",valueEnum:d})})}),n&&s&&(0,e.jsxs)(y.ZP,{wrap:!0,ghost:!0,children:[(0,e.jsxs)(S.Z.Group,{children:[(0,e.jsx)(S.Z,{ghost:!0,statistic:{value:s.availableBalance,title:"\u53EF\u7528BTC:"}}),(0,e.jsx)(y.ZP.Divider,{}),(0,e.jsx)(S.Z,{ghost:!0,statistic:{value:s.maintMargin,title:"\u7EF4\u6301\u4FDD\u8BC1\u91D1:"}})]}),(0,e.jsxs)(S.Z.Group,{children:[(0,e.jsx)(S.Z,{ghost:!0,statistic:{value:s.marginBalance,title:"\u4FDD\u8BC1\u91D1\u4F59\u989D:"}}),(0,e.jsx)(y.ZP.Divider,{}),(0,e.jsx)(S.Z,{ghost:!0,statistic:{value:s.walletBalance,title:"\u94B1\u5305\u4F59\u989D:"}})]})]})]})},Y=l(60014),tt=l(25641),Rt=l(48717),w=S.Z.Statistic,Kt=function(a){var t=a.data,r=(0,h.useState)(!1),n=(0,Z.Z)(r,2),d=n[0],v=n[1];return(0,e.jsx)(Rt.Z,{onResize:function(p){v(p.width<692)},children:(0,e.jsxs)(S.Z.Group,{direction:d?"column":"row",span:24,children:[(0,e.jsx)(S.Z,{title:"\u73B0\u8D27\u4EF7\u683C",statistic:{value:(+t.actuals_price).toFixed(2),suffix:"USDT",valueStyle:{fontWeight:"bold"}}}),(0,e.jsx)(S.Z,{title:"\u5F53\u5B63: "+t.quarter,statistic:{value:((t.futures_price-t.actuals_price)*100*365/(t.actuals_price*t.left_days)).toFixed(2),prefix:(0,e.jsx)("span",{style:{fontSize:16},children:"\u5E74\u5316"}),valueStyle:{fontWeight:"bold"},suffix:"%"},extra:(0,e.jsx)(w,{value:t.left_days,title:"\u5269\u4F59\u5929\u6570: ",layout:"horizontal"}),footer:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(w,{value:(+t.futures_price).toFixed(2),suffix:"USDT",title:"\u671F\u8D27\u4EF7\u683C",layout:"horizontal"}),(0,e.jsx)(w,{value:((t.futures_price-t.actuals_price)*100/t.actuals_price).toFixed(2),suffix:"%",title:"margin",layout:"horizontal"})]})}),(0,e.jsx)(S.Z,{title:"\u6B21\u5B63: "+t.nextQuarter,statistic:{value:((t.futures_next_price-t.actuals_price)*100*365/(t.actuals_price*t.left_next_days)).toFixed(2),prefix:(0,e.jsx)("span",{style:{fontSize:16},children:"\u5E74\u5316"}),valueStyle:{fontWeight:"bold"},suffix:"%"},extra:(0,e.jsx)(w,{value:t.left_next_days,title:"\u5269\u4F59\u5929\u6570: ",layout:"horizontal"}),footer:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(w,{value:(+t.futures_next_price).toFixed(2),suffix:"USDT",title:"\u671F\u8D27\u4EF7\u683C",layout:"horizontal"}),(0,e.jsx)(w,{value:((t.futures_next_price-t.actuals_price)*100/t.actuals_price).toFixed(2),suffix:"%",title:"margin",layout:"horizontal"})]})})]})},"resize-observer")},Mt=l(84232),Qt=function(a){var t=a.balances;if(!t)return(0,e.jsx)(e.Fragment,{});var r=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5408\u7EA6",dataIndex:"symbol",copyable:!0},{title:"x",dataIndex:"leverage"},{title:"\u6570\u91CF",dataIndex:"positionAmt"},{title:"\u4FDD\u8BC1\u91D1\u5360\u7528",dataIndex:"notionalValue"},{title:"\u6301\u4ED3\u6210\u672C",dataIndex:"entryPrice"},{title:"\u7EF4\u6301\u4FDD\u8BC1\u91D1",dataIndex:"maintMargin"},{title:"\u672A\u5B9E\u73B0\u76C8\u4E8F",dataIndex:"unrealizedProfit"},{title:"\u6700\u5927\u53EF\u5F00\u4ED3\u6570",dataIndex:"maxQty"}],n=[];return t&&t.assets&&(n=_(t)),(0,e.jsx)(y.ZP,{span:{xs:24,l:12},children:t&&(0,e.jsx)(Mt.ZP,{columns:r,dataSource:n,rowKey:"id",search:!1,options:{setting:{listsHeight:400}},dateFormatter:"string"})})},P={SPOT:"https://api.binance.com",SPOT_TEST:"https://testnet.binance.vision",FUTURE:"https://dapi.binance.com",FUTURE_TEST:"https://testnet.binancefuture.com"},zt=function(){var a=(0,D.Z)((0,g.Z)().mark(function t(){return(0,g.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("api:getAccounts"),n.abrupt("return",(0,L.WY)("https://m1-coin.littlebrother.icu/account/",{method:"GET",headers:{"Content-Type":"application/json"}}));case 2:case"end":return n.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),Gt=function(){var a=(0,h.useState)("_TEST"),t=(0,Z.Z)(a,2),r=t[0],n=t[1],d=function(){var f=(0,D.Z)((0,g.Z)().mark(function u(i){var c;return(0,g.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=Date.now(),o.abrupt("return",E.ZP.get("https://m1-coin.littlebrother.icu/api/",{method:"GET",headers:{"X-MBX-APIKEY":i.ak,"X-URL":P["SPOT"+r]+"/api/v3/account"},params:{timestamp:c,recvWindow:5e3,signature:I().HmacSHA256("timestamp=".concat(c,"&recvWindow=5000"),i.sk).toString()}}));case 2:case"end":return o.stop()}},u)}));return function(i){return f.apply(this,arguments)}}(),v=function(){var f=(0,D.Z)((0,g.Z)().mark(function u(i){var c;return(0,g.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=Date.now(),o.abrupt("return",E.ZP.get("https://m1-coin.littlebrother.icu/api/",{method:"GET",headers:{"X-MBX-APIKEY":i.ak,"X-URL":P["FUTURE"+r]+"/dapi/v1/account"},params:{timestamp:c,recvWindow:5e3,signature:I().HmacSHA256("timestamp=".concat(c,"&recvWindow=5000"),i.sk).toString()}}));case 2:case"end":return o.stop()}},u)}));return function(i){return f.apply(this,arguments)}}(),s=(0,h.useState)({actuals_price:0,futures_price:0,futures_next_price:0,left_days:10,left_next_days:10,quarter:"BTCUSD_",nextQuarter:"BTCUSD"}),p=(0,Z.Z)(s,2),B=p[0],x=p[1],F=function(){var u=bt(),i=E.ZP.get(P["SPOT"+r]+"/api/v3/ticker/price?symbol=BTCUSDT"),c=E.ZP.get(P["FUTURE"+r]+"/dapi/v1/ticker/price?symbol=BTCUSD_".concat(u.quarter[0])),j=E.ZP.get(P["FUTURE"+r]+"/dapi/v1/ticker/price?symbol=BTCUSD_".concat(u.nextQuarter[0]));Promise.all([i,c,j]).then(function(o){var m=(0,Z.Z)(o,3),k=m[0],H=m[1],z=m[2],O={actuals_price:k.price,futures_price:H[0].price,futures_next_price:z[0].price,left_days:u.quarter[1],left_next_days:u.nextQuarter[1],quarter:"BTCUSD_"+u.quarter[0],nextQuarter:"BTCUSD_"+u.nextQuarter[0]};x(O)})};(0,h.useEffect)(function(){var f=setInterval(function(){F()},1e3);return function(){return clearInterval(f)}},[r]);var b=(0,h.useState)(null),et=(0,Z.Z)(b,2),Vt=et[0],Wt=et[1];(0,h.useEffect)(function(){console.log(B),Wt(Ut(B))},[B.quarter]);var R=(0,L.QT)(zt),Xt=(0,h.useState)(5),at=(0,Z.Z)(Xt,2),rt=at[0],oe=at[1],Yt=(0,h.useState)(0),nt=(0,Z.Z)(Yt,2),K=nt[0],kt=nt[1],Ht=(0,h.useState)(0),ut=(0,Z.Z)(Ht,2),M=ut[0],Ot=ut[1],$t=(0,h.useState)(null),st=(0,Z.Z)($t,2),Q=st[0],Lt=st[1],Nt=(0,h.useState)(null),it=(0,Z.Z)(Nt,2),A=it[0],Jt=it[1],lt=function(u,i){var c=u=="spot"?Lt:Jt;c(i)},qt=(0,h.useState)({}),ot=(0,Z.Z)(qt,2),_t=ot[0],ct=ot[1],dt=function(){var f=(0,D.Z)((0,g.Z)().mark(function u(){var i,c;return(0,g.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(Q){o.next=2;break}return o.abrupt("return");case 2:return o.prev=2,o.next=5,d(Q);case 5:i=o.sent,c=Et(i.balances,"asset"),ct(c),kt(c.BTC.free),o.next=15;break;case 11:o.prev=11,o.t0=o.catch(2),console.log(o.t0),ct({});case 15:case"end":return o.stop()}},u,null,[[2,11]])}));return function(){return f.apply(this,arguments)}}();(0,h.useEffect)(function(){dt();var f=setInterval(dt,rt*1e3);return function(){clearInterval(f)}},[Q,r]);var te=(0,h.useState)({}),ft=(0,Z.Z)(te,2),vt=ft[0],pt=ft[1],mt=function(){var f=(0,D.Z)((0,g.Z)().mark(function u(){var i,c,j;return(0,g.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(A){m.next=2;break}return m.abrupt("return");case 2:return m.prev=2,m.next=5,v(A);case 5:i=m.sent,c=At(i),j=wt(i),pt(i),Ot(j),m.next=16;break;case 12:m.prev=12,m.t0=m.catch(2),console.log(m.t0),pt({});case 16:case"end":return m.stop()}},u,null,[[2,12]])}));return function(){return f.apply(this,arguments)}}();(0,h.useEffect)(function(){console.log("futrueKeyChange:",A),mt();var f=setInterval(mt,rt*1e3);return function(){clearInterval(f)}},[A,r]);var ee=(0,h.useState)(null),ht=(0,Z.Z)(ee,2),xt=ht[0],ae=ht[1];(0,h.useEffect)(function(){console.log("risk",K,M),typeof+K=="number"&&typeof+M=="number"&&ae(T.Z.add(K,M))},[K,M,r]);var U=(0,h.useRef)(),re=function(){var u,i;(u=U.current)===null||u===void 0||(i=u.validateFieldsReturnFormatValue)===null||i===void 0||i.call(u).then(function(c){console.log(c);var j=q(B,c.symbol);console.log(B,j);var o=T.Z.floor(T.Z.div(T.Z.mul(c.btc,j),100)),m=Tt(P["SPOT"+r],"https://m1-coin.littlebrother.icu",c.btc,Q),k=Dt(P["FUTURE"+r],"https://m1-coin.littlebrother.icu",c.symbol,c.leverage,o.toString(),A);Promise.all([m,k]).then(function(H){var z=(0,Z.Z)(H,2),O=z[0],ne=z[1];console.log(O,ne)})})};return(0,e.jsxs)(yt.Z,{children:[r=="_TEST"&&(0,e.jsx)(Zt.Z,{message:"\u6CE8\u610F\uFF1A\u5F53\u524D\u4E3A\u6D4B\u8BD5\u6A21\u5F0F\uFF0C\u8C03\u7528\u7684\u63A5\u53E3\u5747\u4E3A\u5E01\u5B89\u6D4B\u8BD5\u7F51\u7EDC",banner:!0}),(0,e.jsx)(y.ZP,{ghost:!0,style:{marginBottom:20},title:"\u73B0\u8D27\u671F\u8D27\u5BF9\u51B2\u5957\u5229(BTC)",extra:(0,e.jsx)(St.Z,{defaultChecked:r!="_TEST",checkedChildren:"\u7EBF\u4E0A",unCheckedChildren:"\u6D4B\u8BD5",onChange:function(u){n(u?"":"_TEST")}}),children:(0,e.jsx)(Kt,{data:B})}),R.loading==!1&&R.data&&(0,e.jsxs)(y.ZP,{ghost:!0,wrap:!0,style:{marginBottom:20},children:[(0,e.jsx)(y.ZP,{colSpan:12,children:(0,e.jsx)(Ft,{accounts:R.data,updateKey:lt,balances:_t})}),(0,e.jsx)(y.ZP,{colSpan:12,children:(0,e.jsx)(It,{accounts:R.data,updateKey:lt,balances:vt})})]}),(0,e.jsx)(y.ZP,{ghost:!0,style:{marginBottom:20},children:(0,e.jsx)(Qt,{balances:vt})}),(0,e.jsx)(y.ZP,{ghost:!0,style:{marginBottom:20},children:(0,e.jsx)(S.Z,{title:"BTC\u98CE\u9669\u655E\u53E3",statistic:{value:xt&&xt.toString(),suffix:"BTC",valueStyle:{fontWeight:"bold"}}})}),(0,e.jsx)(y.ZP,{style:{marginBottom:20},children:(0,e.jsxs)(C.ZP,{grid:!0,rowProps:{gutter:[16,16]},layout:"inline",submitter:!1,formRef:U,initialValues:{leverage:"1"},onValuesChange:function(u){if("btc"in u){var i,c=q(B,u.symbol);U==null||(i=U.current)===null||i===void 0||i.setFieldsValue({btcAmt:u.btc,btcCont:T.Z.floor(T.Z.div(T.Z.mul(u.btc,c),100))})}},children:[(0,e.jsxs)(C.ZP.Group,{children:[(0,e.jsx)(Y.Z,{label:"BTC",name:"btc",width:"sm",required:!0,colProps:{md:12,xl:8}}),(0,e.jsx)(tt.Z,{colProps:{md:12,xl:8},required:!0,name:"leverage",label:"\u6760\u6746",width:"sm",valueEnum:Array.from({length:50}).reduce(function(f,u,i){return f[i+1]="x"+(i+1),f},{})}),(0,e.jsx)(tt.Z,{colProps:{md:12,xl:8},required:!0,width:"sm",name:"symbol",label:"\u5408\u7EA6",valueEnum:Vt})]}),(0,e.jsxs)(C.ZP.Group,{children:[(0,e.jsx)(Y.Z,{readonly:!0,label:"\u73B0\u8D27\u4E70\u5165BTC\u6570\u91CF",name:"btcAmt",width:"sm",colProps:{md:12,xl:12}}),(0,e.jsx)(Y.Z,{colProps:{md:12,xl:12},readonly:!0,label:"\u671F\u8D27\u5356\u51FA\u5F20\u6570\uFF08100USD/\u5F20\uFF09",name:"btcCont",width:"sm",required:!0})]}),(0,e.jsx)(C.ZP.Group,{children:(0,e.jsx)(gt.Z,{type:"primary",onClick:re,children:"\u5E02\u4EF7\u4E70\u5165BTC\u73B0\u8D27\uFF0C\u5356\u51FABTC\u671F\u6743"})})]})})]})}},42480:function(){}}]);
